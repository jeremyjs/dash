<!doctype html>
<html>
  <head>
    <title>Dash - Speed Reading App</title>
    <style>
    </style>

    <!-- jQuery dependency -->
    <script type="text/javascript" src="http://sdk.spritzinc.com/jQuery/jquery-2.1.0.min.js"></script>
    <link id="spritz-css" rel="stylesheet" type="text/css" href="http://sdk.spritzinc.com/js/1.0/css/spritz.min.css" media="all">
    <link rel="stylesheet" type="text/css" href="style.css" media="all">
    <script src="https://cdn.firebase.com/js/client/1.0.18/firebase.js"></script>
    <script type="text/javascript" src="http://sdk.spritzinc.com/js/1.0/js/spritz.min.js"></script>
    <script type="text/javascript" src="spritz-setup.js"></script>
    <script type="text/javascript">
      var SpritzSettings = {
        clientId: "4524122930975538943",
        redirectUri: "http://tiffanyzhong.github.com/login_success.html",
      };
    </script>       
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>


  </head>
  <body>
    <div class="logo">
      DASH <span class="tagline">A speed reading app</span>
    </div>
    <div id="add-book-btn">Add New Book</div>
      <div class="book-list">
        <div id="books-container"></div>
      </div>


    <div id="spritz-reader">
      <div id="spritzer"></div>
      <div>
      <textarea id="inputText" rows="12" cols="70"></textarea>
      <p class="muted">
        <small>Paste your own text into the field above or click the <b>Fill</b> button to load the sample text, and then click the <b>Spritz!</b> button to start spritzing.</small><br>
        <small>To remove the text from the field, click the <b>Clear</b> button.</small>
      </p>
      <button class="btn btn-default" id="fill" type="submit">Fill</button>
      <button class="btn btn-default" id="clear" type="submit">Clear</button>   
      <button class="btn btn-primary" id="startSpritz" type="submit">Spritz!</button>
    </div>
    </div>

    <form id="add-book-form">
    <h1>Add a New Book</h1>
    <div class="add-book-input">
        <input type="text" class="form-input" id="book-title" placeholder="book Title">
    </div>
    <div class="add-book-input">
        <input class="form-input" type="text" id="book-author" placeholder="book author">
    </div>
    <div class="add-book-input">
        <input class="form-input" type="text" id="book-url" placeholder="book image url">
    </div>
    <div class="add-book-textbox">
        <textarea class="form-input" id="book-content" type="text" placeholder="book Content"></textarea>
    </div>
    <button id="add-book" type="submit" class="submit">Save & Submit Book</button>
  </form>


  <script type="text/javascript">
  $(document).ready(function() {

      // Add book form popup

      $("#add-book-btn").click(function() {
        $("#add-book-form").fadeToggle( "slow" );
      });

      // Firebase add new books

      var ref = new Firebase("https://dashapp.firebaseio.com");

      $("#add-book").bind("click", function() {
      var bookTitle = $("#book-title").val();
      var bookAuthor = $("#book-author").val();
      var bookUrl = $("#book-url").val();
      var bookContent = $("#book-content").val();
      
      var booksRef = ref.child("books");
      
      booksRef.push({title: bookTitle, author: bookAuthor, url: bookUrl, content: bookContent}, function(error) {
          if (error !== null) {
              alert('Unable to push comments to Firebase!');
          } else {
            console.log('data sent!');
            $(".form-input").val("");
            $("#add-book-form").fadeOut( "slow" );
          }
      });
      
      return false;
      });

      // Firebase display books

      var booksRef = ref.child("books");
      booksRef.on('child_added', function (snapshot) {
        var newBook = snapshot.val();
        console.log("Author: " + newBook.author);
        console.log("Title: " + newBook.title);
        console.log("Content: " + newBook.content);

        var booksContainer = $('#books-container');
 
            $('<div>', {class: 'book-container'})
                .html('<div class="b-label">' 
                    + newBook.title + '</div>' + '<div class="b-author">' + newBook.author + '</div>' + '<img class="b-cover" src="' + newBook.url + '"/>' + '<div class="b-content" style="display: none;">' + newBook.author + '</div>').appendTo(booksContainer);

        // Click to read
        $(".book-container").click(function() {

          var text = $(this).children('.b-content').text();

          // Fetch the data object with clicked element ID
          
          console.log(text);

          $('.book-list').hide();
          $('#spritz-reader').fadeIn('Slow');

        });

      });

    });
    </script>

  </body>
</html>
